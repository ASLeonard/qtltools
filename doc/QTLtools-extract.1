.\" Manpage for QTLtools rtc.
.\" Contact halitongen@gmail.com to correct errors or typos.
.TH QTLtools-extract 1 "06 May 2020" "QTLtools-v1.3" "Bioinformatics tools"
.SH NAME
QTLtools extract \- Data extraction mode. 
.SH SYNOPSIS
.B QTLtools extract [\-\-vcf \-\-bed \-\-cov]
.IR relevant_file
.B \-\-out 
.IR output_prefix
.I [OPTIONS]
.SH DESCRIPTION
Extract all the data from the provided files into one flat file.
This will also impute all the missing data.
.SH OPTIONS
.TP
.B \-\-vcf [\fIin.vcf\fR|\fIin.bcf\fR|\fIin.vcf.gz\fB]
Genotypes in VCF/BCF format.
At least one of \fB\-\-vcf \-\-bed \-\-cov\fR is REQUIRED.
.TP
.B \-\-bed \fIquantifications.bed.gz\fR
Molecular phenotype quantifications in BED format.
At least one of \fB\-\-vcf \-\-bed \-\-cov\fR is REQUIRED.
.TP
.B \-\-cov \fIcovariates.txt\fR
Covariates data.
At least one of \fB\-\-vcf \-\-bed \-\-cov\fR is REQUIRED.
.TP
.B \-\-out \fIfilename_prefix\fR
Output file name prefix.
REQUIRED.
.TP
.B \-\-region \fIchr:start-end\fR
Genomic region to be processed.
E.g. chr4:12334456-16334456, or chr5.


.SH OUTPUT FILES
.TP 1
.B .content.txt.gz
Flat file with samples in rows and all the extracted variables in columns.
.TP 1
.B .header.txt
Genomic locations of the extracted variables.

.SH EXAMPLE
.IP o 2
Extract genotypes, gene quantifications, and covariates from a certain region:
.IP "" 2
QTLtools extract \-\-vcf genotypes.chr22.vcf.gz \-\-bed genes.50percent.chr22.bed.gz \-\-cov genes.covariates.pc50.txt.gz \-\-region chr22:17000000-18000000 \-\-out extract_output

.SH SEE ALSO
.IR QTLtools (1)
.\".IR QTLtools-bamstat (1),
.\".IR QTLtools-mbv (1),
.\".IR QTLtools-pca (1),
.\".IR QTLtools-correct (1),
.\".IR QTLtools-cis (1),
.\".IR QTLtools-trans (1),
.\".IR QTLtools-fenrich (1),
.\".IR QTLtools-fdensity (1),
.\".IR QTLtools-rtc (1),
.\".IR QTLtools-rtc-union (1),
.\".IR QTLtools-extract (1),
.\".IR QTLtools-quan (1),
.\".IR QTLtools-rep (1),
.\".IR QTLtools-gwas (1),
.PP
QTLtools website: <https://qtltools.github.io/qtltools>
.SH BUGS
.IP o 2
Versions up to and including 1.2, suffer from a bug in reading missing genotypes in VCF/BCF files. 
This bug affects variants with a DS field in their genotype's FORMAT and have a missing genotype (DS field is .) in one of the samples, in which case genotypes for all the samples are set to missing, effectively removing this variant from the analyses.
.PP
Please submit bugs to <https://github.com/qtltools/qtltools>
.SH
CITATION
Delaneau, O., Ongen, H., Brown, A. et al. A complete tool set for molecular QTL discovery and analysis. \fINat Commun\fR \fB8\fR, 15452 (2017). 
<https://doi.org/10.1038/ncomms15452>
.SH AUTHORS
Olivier Delaneau (olivier.delaneau@gmail.com), Halit Ongen (halitongen@gmail.com)
